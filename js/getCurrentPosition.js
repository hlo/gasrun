var currentLatLng,currentAddress,firstRun=true,city,time,self;function getCurrentPosition(){$("#loadingText").hide().text("Retrieving latest gas prices in your city...").fadeIn(500);$("#origin").hide();if(navigator.geolocation){navigator.geolocation.getCurrentPosition(currentLatLngFcn,showError)}else{alert("Sorry, unable to get current location.\nError Message: "+err);return}}function currentLatLngFcn(a){currentLatLng=new google.maps.LatLng(a.coords.latitude,a.coords.longitude);new google.maps.Geocoder().geocode({latLng:currentLatLng},geoLocationCallback)}function geoLocationCallback(e,c){if(c==google.maps.GeocoderStatus.OK&&typeof e[0]!=="undefined"){if(e[1]){currentAddress=e[0].formatted_address;for(var d=0;d<e[0].address_components.length;d++){for(var a=0;a<e[0].address_components[d].types.length;a++){if(e[0].address_components[d].types[a]=="locality"){city=e[0].address_components[d].long_name;updateCurrentLocationOnPanel();break}}}}}}function updateCurrentLocationOnPanel(){document.getElementById("origin").innerHTML='<span class="glyphicon glyphicon-home red"></span> <strong>'+currentAddress+"</strong>";if(firstRun){$("#loadingText").hide().text("Forecasting tomorrow's trend ...").fadeIn(500);ajax.sendToPython(city,"gas");firstRun=false}$("#origin").fadeIn()}function parseCurrentPosition(c){var g=c.split("city=")[1].split(";")[0],e=c.split("avgGasPrice=")[1].split(";")[0],d=c.split("2dayForecast=")[1].split(";")[0],b="FORECAST ",f=new Date();if(f.getHours()>11){amPm="PM"}else{amPm="AM"}var a=f.getHours()>12?(f.getHours()-12):f.getHours();if(a===0){a=12}time=a+":"+(f.getMinutes()<10?"0":"")+f.getMinutes()+" "+amPm;document.getElementById("gasPrice").innerHTML=Math.round(e*100)/100;document.getElementById("unit").innerHTML="Â¢/L";if(d==="no change"){b+='<h3><span class="glyphicon glyphicon-pause yellow" style="vertical-align:-1px;"/></h3>'}if(d==="up"){b+='<h3><span class="glyphicon glyphicon-arrow-up orange" style="vertical-align:-1px;"/></h3>'}if(d==="down"){b+='<h3><span class="glyphicon glyphicon-arrow-down green" style="vertical-align:-1px;"/></h3>'}document.getElementById("gasCity").innerHTML=g;document.getElementById("gasForecast").innerHTML=b;document.getElementById("time").innerHTML=time;$("#loadingText").remove();$("#loadingPlaceHolder").remove();$("#bodyDashBoard").fadeIn(400);$("#bodyContent").fadeIn(500);$("#footerContainer").fadeIn(500);document.getElementById("originRefresh").onclick=getCurrentPosition}function showError(a){console.log(a.message)}function returnCurrentAddress(){return currentAddress}function returnCurrentLatLng(){return currentLatLng}function returnCurrentCity(){return city}function returnTime(){return time}self={getCurrentPosition:getCurrentPosition,returnCurrentAddress:returnCurrentAddress,returnCurrentLatLng:returnCurrentLatLng,parseCurrentPosition:parseCurrentPosition,returnCurrentCity:returnCurrentCity,returnTime:returnTime,};exports=self;