var error=require("js/error"),_listeners={};function on(d,e,c,b){b=b||[];if(!d){throw"type must be truthy"}if(!e||e===null||typeof e!=="function"){throw"Could not add listener for event '"+d+"' "+(e?"this listener isn't a function":"this listener is undefined")}_listeners[d]=_listeners[d]||[];for(var a=0;a<_listeners[d].length;a++){if(_listeners[d][a]&&_listeners[d][a].origFunc===e){console.warn("Could not add listener for event '"+d+"' this listener is already registered on this event");return}}if(_listeners[d].length===0){module.exports.emit("event.type.added",[d],true)}_listeners[d].push({origFunc:e,func:error.wrap(e,d),once:!!c,paramMatch:b,})}function emit(c,a,b){if(b){c.func.apply(undefined,a)}else{setTimeout(function(){c.func.apply(undefined,a)},1)}}exports={on:function(b,c,a){on(b,c,false,a)},once:function(b,c,a){on(b,c,true,a)},emit:function(b,a,c){a=a||[];c=c||c===undefined;if(_listeners[b]){_listeners[b].forEach(function(f,d,g){var e=f.paramMatch.every(function(i,h){if(a[h]&&a[h].webviewId&&i){return i.webviewId===a[h].webviewId}return i===a[h]||i===module.exports.FILTER_ANY});if(!e){return}emit(f,a,c);if(f.once){delete g[d]}})}},clear:function(a){if(a){delete _listeners[a]}},un:function(a,b){if(a&&b&&_listeners[a]){_listeners[a]=_listeners[a].filter(function(c){return !((c.func===b||c.origFunc===b)&&_listeners[a].indexOf(c)!==-1)});if(_listeners[a].length===0){module.exports.emit("event.type.removed",[a],true)}}},isOn:function(a){if(!_listeners[a]){return false}return typeof _listeners[a]!=="undefined"&&_listeners[a].length!==0},FILTER_ANY:{}};